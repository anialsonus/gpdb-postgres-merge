--
-- Cursor regression tests
--
SET optimizer_disable_missing_stats_collection=true;
BEGIN;
<<<<<<< HEAD
DECLARE foo1 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo2 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo3 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo4 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo5 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo6 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo7 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo8 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo9 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo10 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo11 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo12 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo13 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo14 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo15 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo16 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo17 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo18 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo19 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo20 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo21 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
DECLARE foo22 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
DECLARE foo23 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
=======
DECLARE foo1 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo2 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo3 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo4 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo5 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo6 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo7 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo8 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo9 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo10 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo11 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo12 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo13 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo14 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo15 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo16 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo17 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo18 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo19 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo20 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo21 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
DECLARE foo22 SCROLL CURSOR FOR SELECT * FROM tenk2;
DECLARE foo23 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
>>>>>>> 632e7b6353a99dd139b999efce4cb78db9a1e588
FETCH 1 in foo1;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
(1 row)

FETCH 2 in foo2;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
(2 rows)

FETCH 3 in foo3;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
(3 rows)

FETCH 4 in foo4;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
(4 rows)

FETCH 5 in foo5;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
(5 rows)

FETCH 6 in foo6;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
(6 rows)

FETCH 7 in foo7;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
(7 rows)

FETCH 8 in foo8;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
(8 rows)

FETCH 9 in foo9;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
(9 rows)

FETCH 10 in foo10;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
(10 rows)

FETCH 11 in foo11;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
(11 rows)

FETCH 12 in foo12;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
(12 rows)

FETCH 13 in foo13;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
(13 rows)

FETCH 14 in foo14;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
(14 rows)

FETCH 15 in foo15;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
(15 rows)

FETCH 16 in foo16;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
(16 rows)

FETCH 17 in foo17;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
(17 rows)

FETCH 18 in foo18;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
      17 |    8274 |   1 |    1 |   7 |     17 |      17 |       17 |          17 |        17 |       17 |  34 |   35 | RAAAAA   | GGMAAA   | OOOOxx
(18 rows)

FETCH 19 in foo19;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
      17 |    8274 |   1 |    1 |   7 |     17 |      17 |       17 |          17 |        17 |       17 |  34 |   35 | RAAAAA   | GGMAAA   | OOOOxx
      18 |     376 |   0 |    2 |   8 |     18 |      18 |       18 |          18 |        18 |       18 |  36 |   37 | SAAAAA   | MOAAAA   | AAAAxx
(19 rows)

FETCH 20 in foo20;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
      17 |    8274 |   1 |    1 |   7 |     17 |      17 |       17 |          17 |        17 |       17 |  34 |   35 | RAAAAA   | GGMAAA   | OOOOxx
      18 |     376 |   0 |    2 |   8 |     18 |      18 |       18 |          18 |        18 |       18 |  36 |   37 | SAAAAA   | MOAAAA   | AAAAxx
      19 |    7303 |   1 |    3 |   9 |     19 |      19 |       19 |          19 |        19 |       19 |  38 |   39 | TAAAAA   | XUKAAA   | VVVVxx
(20 rows)

FETCH 21 in foo21;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
      17 |    8274 |   1 |    1 |   7 |     17 |      17 |       17 |          17 |        17 |       17 |  34 |   35 | RAAAAA   | GGMAAA   | OOOOxx
      18 |     376 |   0 |    2 |   8 |     18 |      18 |       18 |          18 |        18 |       18 |  36 |   37 | SAAAAA   | MOAAAA   | AAAAxx
      19 |    7303 |   1 |    3 |   9 |     19 |      19 |       19 |          19 |        19 |       19 |  38 |   39 | TAAAAA   | XUKAAA   | VVVVxx
      20 |    5574 |   0 |    0 |   0 |      0 |      20 |       20 |          20 |        20 |       20 |  40 |   41 | UAAAAA   | KGIAAA   | OOOOxx
(21 rows)

FETCH 22 in foo22;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
      17 |    8274 |   1 |    1 |   7 |     17 |      17 |       17 |          17 |        17 |       17 |  34 |   35 | RAAAAA   | GGMAAA   | OOOOxx
      18 |     376 |   0 |    2 |   8 |     18 |      18 |       18 |          18 |        18 |       18 |  36 |   37 | SAAAAA   | MOAAAA   | AAAAxx
      19 |    7303 |   1 |    3 |   9 |     19 |      19 |       19 |          19 |        19 |       19 |  38 |   39 | TAAAAA   | XUKAAA   | VVVVxx
      20 |    5574 |   0 |    0 |   0 |      0 |      20 |       20 |          20 |        20 |       20 |  40 |   41 | UAAAAA   | KGIAAA   | OOOOxx
      21 |    1628 |   1 |    1 |   1 |      1 |      21 |       21 |          21 |        21 |       21 |  42 |   43 | VAAAAA   | QKCAAA   | AAAAxx
(22 rows)

FETCH 23 in foo23;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
       3 |    5679 |   1 |    3 |   3 |      3 |       3 |        3 |           3 |         3 |        3 |   6 |    7 | DAAAAA   | LKIAAA   | VVVVxx
       4 |    1621 |   0 |    0 |   4 |      4 |       4 |        4 |           4 |         4 |        4 |   8 |    9 | EAAAAA   | JKCAAA   | HHHHxx
       5 |    5557 |   1 |    1 |   5 |      5 |       5 |        5 |           5 |         5 |        5 |  10 |   11 | FAAAAA   | TFIAAA   | HHHHxx
       6 |    2855 |   0 |    2 |   6 |      6 |       6 |        6 |           6 |         6 |        6 |  12 |   13 | GAAAAA   | VFEAAA   | VVVVxx
       7 |    8518 |   1 |    3 |   7 |      7 |       7 |        7 |           7 |         7 |        7 |  14 |   15 | HAAAAA   | QPMAAA   | OOOOxx
       8 |    5435 |   0 |    0 |   8 |      8 |       8 |        8 |           8 |         8 |        8 |  16 |   17 | IAAAAA   | BBIAAA   | VVVVxx
       9 |    4463 |   1 |    1 |   9 |      9 |       9 |        9 |           9 |         9 |        9 |  18 |   19 | JAAAAA   | RPGAAA   | VVVVxx
      10 |    8788 |   0 |    2 |   0 |     10 |      10 |       10 |          10 |        10 |       10 |  20 |   21 | KAAAAA   | AANAAA   | AAAAxx
      11 |    8396 |   1 |    3 |   1 |     11 |      11 |       11 |          11 |        11 |       11 |  22 |   23 | LAAAAA   | YKMAAA   | AAAAxx
      12 |    6605 |   0 |    0 |   2 |     12 |      12 |       12 |          12 |        12 |       12 |  24 |   25 | MAAAAA   | BUJAAA   | HHHHxx
      13 |    5696 |   1 |    1 |   3 |     13 |      13 |       13 |          13 |        13 |       13 |  26 |   27 | NAAAAA   | CLIAAA   | AAAAxx
      14 |    4341 |   0 |    2 |   4 |     14 |      14 |       14 |          14 |        14 |       14 |  28 |   29 | OAAAAA   | ZKGAAA   | HHHHxx
      15 |    1358 |   1 |    3 |   5 |     15 |      15 |       15 |          15 |        15 |       15 |  30 |   31 | PAAAAA   | GACAAA   | OOOOxx
      16 |    9675 |   0 |    0 |   6 |     16 |      16 |       16 |          16 |        16 |       16 |  32 |   33 | QAAAAA   | DIOAAA   | VVVVxx
      17 |    8274 |   1 |    1 |   7 |     17 |      17 |       17 |          17 |        17 |       17 |  34 |   35 | RAAAAA   | GGMAAA   | OOOOxx
      18 |     376 |   0 |    2 |   8 |     18 |      18 |       18 |          18 |        18 |       18 |  36 |   37 | SAAAAA   | MOAAAA   | AAAAxx
      19 |    7303 |   1 |    3 |   9 |     19 |      19 |       19 |          19 |        19 |       19 |  38 |   39 | TAAAAA   | XUKAAA   | VVVVxx
      20 |    5574 |   0 |    0 |   0 |      0 |      20 |       20 |          20 |        20 |       20 |  40 |   41 | UAAAAA   | KGIAAA   | OOOOxx
      21 |    1628 |   1 |    1 |   1 |      1 |      21 |       21 |          21 |        21 |       21 |  42 |   43 | VAAAAA   | QKCAAA   | AAAAxx
      22 |    7045 |   0 |    2 |   2 |      2 |      22 |       22 |          22 |        22 |       22 |  44 |   45 | WAAAAA   | ZKKAAA   | HHHHxx
(23 rows)

CLOSE foo1;
CLOSE foo2;
CLOSE foo3;
CLOSE foo4;
CLOSE foo5;
CLOSE foo6;
CLOSE foo7;
CLOSE foo8;
CLOSE foo9;
CLOSE foo10;
CLOSE foo11;
CLOSE foo12;
-- leave some cursors open, to test that auto-close works.
-- record this in the system view as well (don't query the time field there
-- however)
<<<<<<< HEAD
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
 name  |                           statement                            | is_holdable | is_binary | is_scrollable 
-------+----------------------------------------------------------------+-------------+-----------+---------------
 foo13 | DECLARE foo13 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4; | f           | f         | f
 foo14 | DECLARE foo14 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4; | f           | f         | f
 foo15 | DECLARE foo15 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4; | f           | f         | f
 foo16 | DECLARE foo16 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4; | f           | f         | f
 foo17 | DECLARE foo17 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4; | f           | f         | f
 foo18 | DECLARE foo18 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4; | f           | f         | f
 foo19 | DECLARE foo19 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4; | f           | f         | f
 foo20 | DECLARE foo20 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4; | f           | f         | f
 foo21 | DECLARE foo21 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4; | f           | f         | f
 foo22 | DECLARE foo22 CURSOR FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4; | f           | f         | f
 foo23 | DECLARE foo23 CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4; | f           | f         | f
=======
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors;
 name  |                               statement                               | is_holdable | is_binary | is_scrollable 
-------+-----------------------------------------------------------------------+-------------+-----------+---------------
 foo13 | DECLARE foo13 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2; | f           | f         | t
 foo15 | DECLARE foo15 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2; | f           | f         | t
 foo19 | DECLARE foo19 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2; | f           | f         | t
 foo17 | DECLARE foo17 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2; | f           | f         | t
 foo14 | DECLARE foo14 SCROLL CURSOR FOR SELECT * FROM tenk2;                  | f           | f         | t
 foo21 | DECLARE foo21 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2; | f           | f         | t
 foo23 | DECLARE foo23 SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2; | f           | f         | t
 foo18 | DECLARE foo18 SCROLL CURSOR FOR SELECT * FROM tenk2;                  | f           | f         | t
 foo20 | DECLARE foo20 SCROLL CURSOR FOR SELECT * FROM tenk2;                  | f           | f         | t
 foo22 | DECLARE foo22 SCROLL CURSOR FOR SELECT * FROM tenk2;                  | f           | f         | t
 foo16 | DECLARE foo16 SCROLL CURSOR FOR SELECT * FROM tenk2;                  | f           | f         | t
>>>>>>> 632e7b6353a99dd139b999efce4cb78db9a1e588
(11 rows)

END;
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
 name | statement | is_holdable | is_binary | is_scrollable 
------+-----------+-------------+-----------+---------------
(0 rows)

--
-- NO SCROLL disallows backward fetching
--
BEGIN;
<<<<<<< HEAD
DECLARE foo24 NO SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
=======
DECLARE foo24 NO SCROLL CURSOR FOR SELECT * FROM tenk1 ORDER BY unique2;
>>>>>>> 632e7b6353a99dd139b999efce4cb78db9a1e588
FETCH 1 FROM foo24;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
(1 row)

FETCH BACKWARD 1 FROM foo24; -- should fail
ERROR:  backward scan is not supported in this version of Greenplum Database
END;
--
-- Cursors outside transaction blocks
--
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
 name | statement | is_holdable | is_binary | is_scrollable 
------+-----------+-------------+-----------+---------------
(0 rows)

BEGIN;
DECLARE foo25 CURSOR WITH HOLD FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4;
FETCH FROM foo25;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       0 |    9998 |   0 |    0 |   0 |      0 |       0 |        0 |           0 |         0 |        0 |   0 |    1 | AAAAAA   | OUOAAA   | OOOOxx
(1 row)

FETCH FROM foo25;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       1 |    2838 |   1 |    1 |   1 |      1 |       1 |        1 |           1 |         1 |        1 |   2 |    3 | BAAAAA   | EFEAAA   | OOOOxx
(1 row)

COMMIT;
FETCH FROM foo25;
 unique1 | unique2 | two | four | ten | twenty | hundred | thousand | twothousand | fivethous | tenthous | odd | even | stringu1 | stringu2 | string4 
---------+---------+-----+------+-----+--------+---------+----------+-------------+-----------+----------+-----+------+----------+----------+---------
       2 |    2716 |   0 |    2 |   2 |      2 |       2 |        2 |           2 |         2 |        2 |   4 |    5 | CAAAAA   | MAEAAA   | AAAAxx
(1 row)

--FETCH BACKWARD FROM foo25;
--FETCH ABSOLUTE -1 FROM foo25;
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
 name  |                                statement                                 | is_holdable | is_binary | is_scrollable 
-------+--------------------------------------------------------------------------+-------------+-----------+---------------
 foo25 | DECLARE foo25 CURSOR WITH HOLD FOR SELECT * FROM tenk2 ORDER BY 1,2,3,4; | t           | f         | f
(1 row)

CLOSE foo25;
--
-- ROLLBACK should close holdable cursors
--
BEGIN;
<<<<<<< HEAD
DECLARE foo26 CURSOR WITH HOLD FOR SELECT * FROM tenk1 ORDER BY 1,2,3,4;
=======
DECLARE foo26 CURSOR WITH HOLD FOR SELECT * FROM tenk1 ORDER BY unique2;
>>>>>>> 632e7b6353a99dd139b999efce4cb78db9a1e588
ROLLBACK;
-- should fail
FETCH FROM foo26;
ERROR:  cursor "foo26" does not exist
--
-- Parameterized DECLARE needs to insert param values into the cursor portal
--
BEGIN;
CREATE FUNCTION declares_cursor(text)
   RETURNS void
   AS 'DECLARE c CURSOR FOR SELECT stringu1 FROM tenk1 WHERE stringu1 LIKE $1;'
   LANGUAGE SQL READS SQL DATA;
SELECT declares_cursor('AB%');
 declares_cursor 
-----------------
 
(1 row)

FETCH ALL FROM c;
 stringu1 
----------
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
 ABAAAA
(15 rows)

ROLLBACK;
--
-- Test behavior of both volatile and stable functions inside a cursor;
-- in particular we want to see what happens during commit of a holdable
-- cursor
--
create temp table tt1(f1 int);
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'f1' as the Greenplum Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
create function count_tt1_v() returns int8 as
'select count(*) from tt1' language sql volatile READS SQL DATA;
create function count_tt1_s() returns int8 as
'select count(*) from tt1' language sql stable READS SQL DATA;
begin;
insert into tt1 values(1);
declare c1 cursor for select count_tt1_v(), count_tt1_s();
insert into tt1 values(2);
-- fetch all from c1; -- DISABLED: see open JIRA MPP-835
-- start_ignore
 count_tt1_v | count_tt1_s 
-------------+-------------
           2 |           1
(1 row)
-- end_ignore
rollback;
begin;
insert into tt1 values(1);
declare c2 cursor with hold for select count_tt1_v(), count_tt1_s();
insert into tt1 values(2);
commit;
delete from tt1;
-- fetch all from c2; -- DISABLED: see open JIRA MPP-835
-- start_ignore
 count_tt1_v | count_tt1_s 
-------------+-------------
           2 |           1
(1 row)
-- end_ignore
drop function count_tt1_v();
drop function count_tt1_s();
-- Create a cursor with the BINARY option and check the pg_cursors view
BEGIN;
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
 name |                              statement                               | is_holdable | is_binary | is_scrollable 
------+----------------------------------------------------------------------+-------------+-----------+---------------
 c2   | declare c2 cursor with hold for select count_tt1_v(), count_tt1_s(); | t           | f         | f
(1 row)

DECLARE bc BINARY CURSOR FOR SELECT * FROM tenk1;
SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
 name |                              statement                               | is_holdable | is_binary | is_scrollable 
------+----------------------------------------------------------------------+-------------+-----------+---------------
 bc   | DECLARE bc BINARY CURSOR FOR SELECT * FROM tenk1;                    | f           | t         | f
 c2   | declare c2 cursor with hold for select count_tt1_v(), count_tt1_s(); | t           | f         | f
(2 rows)

ROLLBACK;
-- We should not see the portal that is created internally to
-- implement EXECUTE in pg_cursors
PREPARE cprep AS
  SELECT name, statement, is_holdable, is_binary, is_scrollable FROM pg_cursors ORDER BY name;
EXECUTE cprep;
 name |                              statement                               | is_holdable | is_binary | is_scrollable 
------+----------------------------------------------------------------------+-------------+-----------+---------------
 c2   | declare c2 cursor with hold for select count_tt1_v(), count_tt1_s(); | t           | f         | f
(1 row)

-- test CLOSE ALL;
SELECT name FROM pg_cursors ORDER BY 1;
 name 
------
 c2
(1 row)

CLOSE ALL;
SELECT name FROM pg_cursors ORDER BY 1;
 name 
------
(0 rows)

BEGIN;
DECLARE foo1 CURSOR WITH HOLD FOR SELECT 1;
DECLARE foo2 CURSOR WITHOUT HOLD FOR SELECT 1;
SELECT name FROM pg_cursors ORDER BY 1;
 name 
------
 foo1
 foo2
(2 rows)

CLOSE ALL;
SELECT name FROM pg_cursors ORDER BY 1;
 name 
------
(0 rows)

COMMIT;
--
-- Tests for updatable cursors
--
CREATE TEMP TABLE uctest(f1 int, f2 text);
INSERT INTO uctest VALUES (1, 'one'), (2, 'two'), (3, 'three');
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  1 | one
  2 | two
  3 | three
(3 rows)

-- Check DELETE WHERE CURRENT
BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM uctest;
FETCH 2 FROM c1;
 f1 | f2  
----+-----
  1 | one
  2 | two
(2 rows)

DELETE FROM uctest WHERE CURRENT OF c1;
-- should show deletion
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  1 | one
  3 | three
(2 rows)

-- cursor did not move
FETCH ALL FROM c1;
 f1 |  f2   
----+-------
  3 | three
(1 row)

-- cursor is insensitive
MOVE BACKWARD ALL IN c1;
FETCH ALL FROM c1;
 f1 |  f2   
----+-------
  1 | one
  2 | two
  3 | three
(3 rows)

COMMIT;
-- should still see deletion
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  1 | one
  3 | three
(2 rows)

-- Check UPDATE WHERE CURRENT; this time use FOR UPDATE
BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM uctest FOR UPDATE;
FETCH c1;
 f1 | f2  
----+-----
  1 | one
(1 row)

UPDATE uctest SET f1 = 8 WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  3 | three
  8 | one
(2 rows)

COMMIT;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  3 | three
  8 | one
(2 rows)

-- Check repeated-update and update-then-delete cases
BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM uctest;
FETCH c1;
 f1 |  f2   
----+-------
  3 | three
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  8 | one
 13 | three
(2 rows)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  8 | one
 23 | three
(2 rows)

-- insensitive cursor should not show effects of updates or deletes
FETCH RELATIVE 0 FROM c1;
 f1 |  f2   
----+-------
  3 | three
(1 row)

DELETE FROM uctest WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 | f2  
----+-----
  8 | one
(1 row)

DELETE FROM uctest WHERE CURRENT OF c1; -- no-op
SELECT * FROM uctest;
 f1 | f2  
----+-----
  8 | one
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1; -- no-op
SELECT * FROM uctest;
 f1 | f2  
----+-----
  8 | one
(1 row)

FETCH RELATIVE 0 FROM c1;
 f1 |  f2   
----+-------
  3 | three
(1 row)

ROLLBACK;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  3 | three
  8 | one
(2 rows)

BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM uctest FOR UPDATE;
FETCH c1;
 f1 |  f2   
----+-------
  3 | three
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  8 | one
 13 | three
(2 rows)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  8 | one
 23 | three
(2 rows)

DELETE FROM uctest WHERE CURRENT OF c1;
SELECT * FROM uctest;
 f1 | f2  
----+-----
  8 | one
(1 row)

DELETE FROM uctest WHERE CURRENT OF c1; -- no-op
SELECT * FROM uctest;
 f1 | f2  
----+-----
  8 | one
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1; -- no-op
SELECT * FROM uctest;
 f1 | f2  
----+-----
  8 | one
(1 row)

--- sensitive cursors can't currently scroll back, so this is an error:
FETCH RELATIVE 0 FROM c1;
ERROR:  cursor can only scan forward
HINT:  Declare it with SCROLL option to enable backward scan.
ROLLBACK;
SELECT * FROM uctest;
 f1 |  f2   
----+-------
  3 | three
  8 | one
(2 rows)

-- Check inheritance cases
CREATE TEMP TABLE ucchild () inherits (uctest);
INSERT INTO ucchild values(100, 'hundred');
SELECT * FROM uctest;
 f1  |   f2    
-----+---------
   3 | three
   8 | one
 100 | hundred
(3 rows)

BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM uctest;
FETCH 1 FROM c1;
 f1 |  f2   
----+-------
  3 | three
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
FETCH 1 FROM c1;
 f1 | f2  
----+-----
  8 | one
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
FETCH 1 FROM c1;
 f1  |   f2    
-----+---------
 100 | hundred
(1 row)

UPDATE uctest SET f1 = f1 + 10 WHERE CURRENT OF c1;
FETCH 1 FROM c1;
 f1 | f2 
----+----
(0 rows)

COMMIT;
SELECT * FROM uctest;
 f1  |   f2    
-----+---------
  13 | three
  18 | one
 110 | hundred
(3 rows)

-- Check various error cases
DELETE FROM uctest WHERE CURRENT OF c1;  -- fail, no such cursor
ERROR:  cursor "c1" does not exist
DECLARE cx CURSOR WITH HOLD FOR SELECT * FROM uctest;
DELETE FROM uctest WHERE CURRENT OF cx;  -- fail, can't use held cursor
ERROR:  cursor "cx" is held from a previous transaction
BEGIN;
DECLARE c CURSOR FOR SELECT * FROM tenk2;
DELETE FROM uctest WHERE CURRENT OF c;  -- fail, cursor on wrong table
ERROR:  cursor "c" is not a simply updatable scan of table "uctest"
ROLLBACK;
BEGIN;
DECLARE c CURSOR FOR SELECT * FROM tenk1 JOIN tenk2 USING (unique1);
DELETE FROM tenk1 WHERE CURRENT OF c;  -- fail, cursor is on a join
ERROR:  cursor "c" is not a simply updatable scan of table "tenk1"
ROLLBACK;
BEGIN;
DECLARE c CURSOR FOR SELECT f1,count(*) FROM uctest GROUP BY f1;
DELETE FROM uctest WHERE CURRENT OF c;  -- fail, cursor is on aggregation
ERROR:  cursor "c" is not a simply updatable scan of table "uctest"
ROLLBACK;
BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM uctest;
DELETE FROM uctest WHERE CURRENT OF c1; -- fail, no current row
ERROR:  cursor "c1" is not positioned on a row
ROLLBACK;
-- WHERE CURRENT OF may someday work with views, but today is not that day.
-- For now, just make sure it errors out cleanly.
CREATE TEMP VIEW ucview AS SELECT * FROM uctest;
CREATE RULE ucrule AS ON DELETE TO ucview DO INSTEAD
  DELETE FROM uctest WHERE f1 = OLD.f1;
BEGIN;
DECLARE c1 CURSOR FOR SELECT * FROM ucview;
FETCH FROM c1;
 f1 |  f2   
----+-------
 13 | three
(1 row)

DELETE FROM ucview WHERE CURRENT OF c1; -- fail, views not supported
ERROR:  WHERE CURRENT OF on a view is not implemented
ROLLBACK;
